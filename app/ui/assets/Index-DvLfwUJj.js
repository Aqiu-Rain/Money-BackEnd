import{d as S,_ as x,r as y,c as v,o as N,a as C,b as a,e as t,u as l,w as r,f as d,g as D,m as V,s as O,h,t as W,i as E,j as I}from"./index-D601hLYv.js";import{u as B,g as P,s as T}from"./settings-BhTuWeNl.js";const H=S("websocketStore",{state(){return{data:[],status:"等待链接",message:"",socket:null}},actions:{setData(i){this.data.push(i)},connect(i){this.socket=new WebSocket(i),this.socket.onopen=()=>{this.socket.readyState===WebSocket.OPEN&&(this.status="已经连接")},this.socket.onclose=()=>{this.socket.readyState===WebSocket.OPEN&&(this.status="等待链接",this.socket.close())},this.socket.onerror=o=>{this.socket.close(),this.status="等待链接",console.log(o),this.message=o},this.socket.onmessage=o=>{const u=JSON.parse(o.data);u.type==="serial_data"&&this.setData(u.data)}},disconnect(){this.socket.close(),this.status="等待链接",this.socket=null},sendData(i){this.socket.send(JSON.stringify(i))}}}),J={class:"container"},M={class:"header"},j={class:"header-right"},z={class:"search-container"},U={class:"function-area"},q={class:"content"},A=["src"],F="ws://127.0.0.1:8000/ws",G={__name:"Index",setup(i){const o=y(""),u=v(()=>window.innerHeight-80),n=H(),_=B();N(()=>{P().then(c=>{_.setItem(c.data)}).catch(c=>{T("error","获取设置失败")})});const g=()=>{n.connect(F),setTimeout(()=>{if(console.log(n.socket.readyState),n.socket.readyState===WebSocket.OPEN){let c={cmd:"start",param:_.setting};n.sendData(c)}},1e3)},m=()=>{n.disconnect()};return(c,s)=>{const b=d("el-input"),k=d("el-tag"),f=d("el-button"),e=d("el-table-column"),w=d("el-table");return D(),C("div",J,[a("div",M,[s[3]||(s[3]=a("div",{class:"header-left"},[a("h3",{style:{"font-family":"幼圆,serif"}},"点钞记录系统")],-1)),a("div",j,[a("div",z,[t(b,{modelValue:o.value,"onUpdate:modelValue":s[0]||(s[0]=p=>o.value=p),size:"large","prefix-icon":l(V),"suffix-icon":l(O)},null,8,["modelValue","prefix-icon","suffix-icon"])]),a("div",U,[t(k,{round:"",type:"primary",style:{"margin-right":"15px"}},{default:r(()=>[h(W(l(n).status),1)]),_:1}),t(f,{icon:l(E),round:"",type:"primary",onClick:g},{default:r(()=>s[1]||(s[1]=[h("Start")])),_:1},8,["icon"]),t(f,{icon:l(I),round:"",type:"danger",onClick:m},{default:r(()=>s[2]||(s[2]=[h("Stop")])),_:1},8,["icon"])])])]),a("div",q,[t(w,{data:l(n).data,height:u.value,border:"",style:{width:"100%"}},{default:r(()=>[t(e,{prop:"date",label:"日期",width:"150",fixed:"left",align:"center"}),t(e,{prop:"time",label:"时间",width:"120",fixed:"left",align:"center"}),t(e,{prop:"tf_flag",label:"真伪标志",width:"120",fixed:"left",align:"center"}),t(e,{prop:"valuta",label:"币值",width:"120",align:"center"}),t(e,{prop:"fsn_count",label:"纸币计数",width:"100",align:"center"}),t(e,{prop:"char_num",label:"冠字号码字符数",width:"130",align:"center"}),t(e,{prop:"sno",label:"冠字号码",width:"120",align:"center"}),t(e,{prop:"machine_sno",label:"机具编号",width:"120",align:"center"}),t(e,{prop:"reserve1",label:"保留字",align:"center"}),t(e,{fixed:"right",prop:"image_data",label:"冠字号码图像",align:"center"},{default:r(p=>[a("img",{src:"data:image/bmp;base64,"+p.row.image_data,alt:"冠字号码图像"},null,8,A)]),_:1})]),_:1},8,["data","height"])])])}}},Q=x(G,[["__scopeId","data-v-014c1133"]]);export{Q as default};
